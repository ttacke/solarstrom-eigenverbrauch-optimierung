<html>
<head>
	<title>Sonnenrech 19</title>
	<script type="text/javascript">
		var anzahl_fehler = 0;
		
		function setze_lokale_daten() {
			var max_i = document.getElementById('max_i_value').innerHTML * 1;
			if (!document.max_i || document.max_i < max_i) {
				document.max_i = max_i * 1;
				document.max_i_phase = document.getElementById('max_i_phase').innerHTML;
				var now = new Date();
				document.max_i_uhrzeit = now.getHours() + ':' + (now.getMinutes() < 10 ? '0' : '') + now.getMinutes();
			}
			document.getElementById('marker').innerHTML = document.max_i_uhrzeit;
			document.getElementById('max_i').innerHTML = 'max I=' + document.max_i + 'A&nbsp(' + document.max_i_phase + ')&nbsp;';
		}
		
		function reload() {
			var xhr = new XMLHttpRequest();
			xhr.onreadystatechange = function(args) {
				if (this.readyState == this.DONE) {
					if (this.status == 200) {
						anzahl_fehler = 0;
						document.getElementsByTagName('html')[0].innerHTML = this.responseText;
						setze_lokale_daten();
						document.getElementsByTagName('body')[0].className = '';
					} else {
						anzahl_fehler++;
						document.getElementById('max_i').innerHTML = '';
						document.getElementById('fehler').innerHTML = ' ' + anzahl_fehler + ' FEHLER!';
						document.getElementsByTagName('body')[0].className = 'hat_fehler';
					}
				}
			};
			xhr.open('GET', '/?time=' + Math.floor(new Date().getTime() / 1000), true);
			xhr.timeout = 30 * 1000;
			xhr.send();
		}
		
		// TODO setInterval(reload, 60 * 1000);
	</script>
	<style>
		body {
			padding: 0.5rem;
			padding-top: 0.5rem;
		}
		
		/*transform:rotate(180deg); geht im Kindle nicht*/
		* {
			font-family: sans-serif;
			font-weight: bold;
			color: #000;
		}
		
		td {
			font-size: 5rem;
			line-height: 1.1;
		}
		
		table {
			width: 100%;
		}
		
		tr.last td {
			border-top: 5px solid #000;
		}
		
		.zahl {
			text-align: right;
			padding-left: 0.3rem;
		}
		
		.label {
			font-size: 1.5rem;
			text-align: right;
		}
		
		.einheit {
			padding-left: 0.3rem;
			width: 0%;
		}
		
		.markerline div {
			text-align: center;
			font-size: 2.5rem;
		}
		
		.markerline div span {
			color: #999;
		}
		
		.markerline div #max_i {
		}
		
		.markerline div #marker {
		}
		
		.speicher_aus td {
			color: #999;
		}
		
		.hat_fehler * {
			color: #999;
		}
		
		.hat_fehler .markerline div span {
			color: #000;
			text-decoration: underline;
		}
	</style>
</head>
<body onclick="reload();" onload="setze_lokale_daten();">
<div style="display:none"><span id=max_i_value>1.2</span><span id=max_i_phase>3</span></div>
<table cellspacing=0 border=1>
	<tr>
		<td class=zahl style="width:auto">-230</td>
		<td class="label einheit" style="width:0.5rem">W</td>
		<td class=zahl style="width:1.8em;font-size:3.5rem;">5.7</td>
		<td class="label einheit" style="width:0.5rem">%</td>
	</tr>
</table>
<b>Wolken:67 %</b>
<b>Sonne:0 &permil;</b>
<div class=markerline>
	<div><span id=max_i></span><span id=marker>starte...</span><span id=fehler></span></div>
</div>
</body>
</html>
